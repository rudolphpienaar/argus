<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARGUS - ATLAS Resource Graphical User System</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Antonio:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/lcars.css">
    <link rel="stylesheet" href="css/federation.css">
    <link rel="stylesheet" href="css/marketplace.css">
</head>
<body class="state-locked">
    <section class="wrap-all">
        <!-- ============================================================ -->
        <!-- TOP SECTION - Header with data cascade and navigation        -->
        <!-- ============================================================ -->
        <div class="wrap">
            <div class="left-frame-top" id="top-frame">
                <div class="panel-1">
                    <span id="lcars-date">01/24/2026</span>
                    <span class="hop" id="lcars-time">12:00:00</span>
                </div>
                <div class="panel-2">
                    <span id="current-persona">DEVELOPER</span>
                    <span class="hop" id="app-version">v0.0.0</span>
                </div>
            </div>
            <!-- Content area (seagap + ARGUS + bars) -->
            <div class="content-top" id="content-top">
                <!-- Telemetry Dashboard (Visible only in LOCKED state) -->
                <div class="telemetry-wrapper">
                    <div class="tele-col">
                        <div class="tele-header">ACTIVE PROCESSES</div>
                        <div class="tele-content monospace" id="tele-proc"></div>
                    </div>
                    <div class="tele-col">
                        <div class="tele-header">NETWORK TRAFFIC</div>
                        <div class="tele-content monospace" id="tele-net"></div>
                    </div>
                    <div class="tele-col">
                        <div class="tele-header">SYSTEM LOGS</div>
                        <div class="tele-content monospace" id="tele-log"></div>
                    </div>
                </div>

                <!-- SeaGaP Tracker with Telemetry Windows -->
                <div class="seagap-panel" id="seagap-panel">
                    <!-- ... -->
                </div>

                <!-- ARGUS Banner and Pills -->
                <div class="argus-column">
                    <div class="banner">ARGUS</div>
                    <div class="pill-stack">
                        <button onclick="store.toggleMarketplace()" class="pill-btn market-pill">MARKETPLACE</button>
                        <button onclick="user_logout()" class="pill-btn logout-pill">LOGOUT</button>
                        <button onclick="stage_next()" class="pill-btn next-pill" id="btn-next">NEXT</button>
                    </div>
                </div>

                <!-- Bar panel at bottom -->
                <div class="bar-panel first-bar-panel">
                    <div class="bar-1"></div>
                    <div class="bar-2"></div>
                    <div class="bar-3"></div>
                    <div class="bar-4"></div>
                    <div class="bar-5"></div>
                </div>
            </div>
        </div>

        <!-- ============================================================ -->
        <!-- BOTTOM SECTION - Main content area                           -->
        <!-- ============================================================ -->
        <div class="wrap" id="gap">
            <div class="left-frame">
                <button onclick="ui_toggleTopFrame(event)" id="topBtn" class="panel-button">
                    <span class="hop">show</span> detail
                </button>
                <div class="sidebar-panels">
                    <div class="panel-3 stage-indicator" data-stage="search" id="gutter-1">01<span class="hop">-SEARCH</span></div>
                    <div class="panel-4 stage-indicator" data-stage="gather" id="gutter-2">02<span class="hop">-GATHER</span></div>
                    <div class="panel-5 stage-indicator" data-stage="process" id="gutter-3">03<span class="hop">-PROCESS</span></div>
                    <div class="panel-6 stage-indicator" data-stage="monitor" id="gutter-4">04<span class="hop">-MONITOR</span></div>
                </div>
                <div>
                    <div class="panel-7 stage-indicator" data-stage="post" id="gutter-5">05<span class="hop">-POST</span></div>
                </div>
            </div>
            <div class="right-frame">
                <!-- GLOBAL INTELLIGENCE CONSOLE (The Drawer) -->
                <div id="intelligence-console" class="terminal-drawer"></div>

                <!-- MARKETPLACE OVERLAY -->
                <div id="marketplace-overlay" class="marketplace-overlay hidden">
                    <div class="market-header">
                        <div class="lcars-header-block" style="border-color: var(--sky);">
                            <h2 style="margin: 0; color: var(--sky);">ATLAS MARKETPLACE</h2>
                            <div class="lcars-subtitle">ChRIS PLUGIN & ASSET REGISTRY</div>
                        </div>
                        <button onclick="store.toggleMarketplace(false)" class="pill-btn" style="width: 100px; background: var(--mars);">CLOSE</button>
                    </div>
                    <div class="market-filters">
                        <button class="filter-pill active" onclick="market_filter('all')">ALL</button>
                        <button class="filter-pill" onclick="market_filter('plugin')">PLUGINS</button>
                        <button class="filter-pill" onclick="market_filter('dataset')">DATASETS</button>
                        <button class="filter-pill" onclick="market_filter('model')">MODELS</button>
                        <button class="filter-pill" onclick="market_filter('annotation')">ANNOTATIONS</button>
                    </div>
                    <div class="market-grid" id="market-grid">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- FEDERATION OVERLAY (Transition Animation) -->
                <div id="federation-overlay" class="federation-overlay hidden">
                    <div class="fed-container">
                        <div class="fed-hub">
                            <div class="fed-icon factory-icon">FACTORY</div>
                            <div class="fed-label">ATLAS HUB</div>
                        </div>
                        <div class="fed-spokes" id="fed-spokes">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                    <div class="fed-status-bar">
                        <span id="fed-status-text">INITIALIZING FACTORY...</span>
                        <div class="fed-progress">
                            <div class="fed-progress-bar" id="fed-progress-bar"></div>
                        </div>
                    </div>
                </div>

                <div class="bar-panel main-bar-panel">
                    <div class="bar-6" onclick="terminal_toggle()" style="cursor: pointer;"></div>
                    <div class="bar-7"></div>
                    <div class="bar-8"></div>
                    <div class="bar-9">
                        <!-- Pullable Access Strip -->
                        <div id="access-strip" class="lcars-access-strip"></div>
                    </div>
                    <div class="bar-10"></div>
                </div>

                <main id="main-content">
                    <!-- LOGIN Stage -->
                    <div class="stage-content active" data-stage="login">
                        <div class="login-container">
                            <div class="lcars-header-block">
                                <h1 style="margin-bottom: 0;">ATLAS RESOURCE GRAPHICAL USER SYSTEM</h1>
                                <div class="lcars-subtitle">SECURE FEDERATED GATEWAY</div>
                            </div>
                            
                            <div class="login-grid">
                                <div class="login-info">
                                    <p class="hop" style="font-size: 1.5rem; line-height: 1.2; margin-bottom: 2rem;">
                                        RESTRICTED ACCESS<br>
                                        VERIFIED IDENTITY REQUIRED
                                    </p>
                                    <p class="blurb">
                                        System Status: <span class="status-alert">OPERATIONAL</span><br>
                                        Security Level: <span class="status-alert">TIER 4</span><br>
                                        Encryption: <span class="status-alert">AES-256-GCM</span>
                                    </p>
                                    <p class="blurb-text">
                                        This system is for the use of authorized users only. Individuals using this computer system without authority, or in
                                        excess of their authority, are subject to having all of their activities on this system monitored and recorded.
                                    </p>
                                </div>

                                <div class="login-form">
                                    <div class="form-group">
                                        <label for="login-user">USER ID</label>
                                        <input type="text" id="login-user" placeholder="ENTER ID" autocomplete="off">
                                    </div>
                                    <div class="form-group">
                                        <label for="login-pass">ACCESS KEY</label>
                                        <input type="password" id="login-pass" placeholder="ENTER KEY">
                                    </div>
                                    <div style="display: flex; justify-content: flex-end; margin-top: 2rem;">
                                        <button onclick="user_authenticate()" class="button-honey" style="width: 200px; height: 60px; border-radius: 30px;">
                                            INITIATE SESSION
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ROLE SELECTION Stage -->
                    <div class="stage-content" data-stage="role-selection">
                        <div class="login-container">
                            <div class="lcars-header-block">
                                <h1 style="margin-bottom: 0;">SELECT ROLE</h1>
                                <div class="lcars-subtitle">CHOOSE OPERATIONAL CONTEXT</div>
                            </div>
                            
                            <div class="role-grid">
                                <button onclick="role_select('developer')" class="role-card">
                                    <div class="role-icon">DEV</div>
                                    <h3>DEVELOPER</h3>
                                    <p>Federated Model Training<br>Algorithm Design</p>
                                </button>
                                
                                <button onclick="role_select('annotator')" class="role-card" style="border-color: var(--canary);">
                                    <div class="role-icon" style="background-color: var(--canary);">ANN</div>
                                    <h3 style="color: var(--canary);">ANNOTATOR</h3>
                                    <p>Data Labeling<br>Ground Truth Generation</p>
                                </button>
                                
                                <button onclick="role_select('provider')" class="role-card" style="border-color: var(--tamarillo);">
                                    <div class="role-icon" style="background-color: var(--tamarillo);">PVD</div>
                                    <h3 style="color: var(--tamarillo);">PROVIDER</h3>
                                    <p>Data Contribution<br>Usage Tracking</p>
                                </button>

                                <button onclick="role_select('scientist')" class="role-card" style="border-color: var(--sky);">
                                    <div class="role-icon" style="background-color: var(--sky);">SCI</div>
                                    <h3 style="color: var(--sky);">SCIENTIST</h3>
                                    <p>Analysis & Experiments<br>Cohort Discovery</p>
                                </button>

                                <button onclick="role_select('clinician')" class="role-card" style="border-color: var(--galaxy);">
                                    <div class="role-icon" style="background-color: var(--galaxy);">CLI</div>
                                    <h3 style="color: var(--galaxy);">CLINICIAN</h3>
                                    <p>Inference & Diagnosis<br>Patient Review</p>
                                </button>

                                <button onclick="role_select('admin')" class="role-card" style="border-color: var(--mars);">
                                    <div class="role-icon" style="background-color: var(--mars);">ADM</div>
                                    <h3 style="color: var(--mars);">ADMIN</h3>
                                    <p>System Oversight<br>User Management</p>
                                </button>

                                <button onclick="role_select('fda')" class="role-card" style="border-color: #fff;">
                                    <div class="role-icon" style="background-color: #fff; color: black;">FDA</div>
                                    <h3 style="color: #fff;">REGULATORY</h3>
                                    <p>Compliance Auditing<br>Model Safety Review</p>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="stage-content" data-stage="search">
                        <!-- TOP CONTROLS (Visible only when authenticated) -->
                        <div id="search-query-panel" style="display: none; margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: flex-end; align-items: center; gap: 0.5rem;">
                                <button onclick="lcarslm_simulate()" class="pill-btn" style="height: 30px; background-color: var(--nebula); color: black; font-size: 0.8rem; width: auto; padding: 0 1.5rem;">SWITCH TO SIMULATION</button>
                                <button onclick="lcarslm_reset()" class="pill-btn" style="height: 30px; background-color: var(--mars); color: white; font-size: 0.8rem; width: auto; padding: 0 1.5rem;">RESET KEY</button>
                            </div>
                        </div>

                        <!-- AUTH PANEL -->
                        <div id="search-auth-panel" style="margin-bottom: 2rem;">
                            <div class="lcars-header-block" style="border-color: var(--october-sunset);">
                                <h3 style="margin: 0; color: var(--october-sunset);">SECURITY CLEARANCE REQUIRED</h3>
                            </div>
                            <p>To access the AI Core, please input your operational parameters.</p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                <div class="form-group" style="margin-bottom: 0;">
                                    <label>PROVIDER</label>
                                    <select id="api-provider-select" style="height: 40px; border: 2px solid var(--orange); background: #222; color: var(--honey);">
                                        <option value="gemini">Google Gemini</option>
                                        <option value="openai">OpenAI</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin-bottom: 0;">
                                    <label>MODEL ID (OPTIONAL)</label>
                                    <input type="text" id="api-model-input" placeholder="gemini-flash-latest" style="height: 40px;">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>ENCRYPTION KEY</label>
                                <div style="display: flex; gap: 1rem;">
                                    <input type="password" id="api-key-input" placeholder="API Key..." style="flex: 1; height: 40px;">
                                    <button onclick="lcarslm_auth()" class="pill-btn" style="height: 40px; background-color: var(--october-sunset); color: white; width: 150px;">AUTHENTICATE</button>
                                </div>
                            </div>
                            
                            <div style="margin-top: 2rem; display: flex; flex-direction: column; align-items: center; gap: 1rem;">
                                <span style="font-size: 0.8rem; color: var(--harvestgold);">OR BYPASS SYSTEM AUTHENTICATION</span>
                                <button onclick="lcarslm_simulate()" class="pill-btn" style="height: 50px; background-color: var(--nebula); color: black; width: 100%; font-size: 1.1rem;">ACTIVATE SIMULATION MODE</button>
                            </div>
                        </div>

                        <!-- LEGACY CONTROLS (Fallback) -->
                        <div class="search-controls" style="opacity: 0.5; transform: scale(0.95); transform-origin: top left;">
                            <!-- ... controls ... -->
                        </div>

                        <div class="dataset-grid" id="dataset-results">
                            <!-- Populated by JS -->
                        </div>

                        <div class="buttons mt-2">
                            <button onclick="stage_advanceTo('gather')" id="btn-to-gather" disabled>
                                Proceed to Gather
                            </button>
                            <span id="selection-count" class="selection-info">0 datasets selected</span>
                        </div>
                    </div>

                    <!-- GATHER Stage -->
                    <div class="stage-content" data-stage="gather">
                        <div class="filesystem-view">
                            <div class="file-tree" id="file-tree">
                                <!-- Populated by JS -->
                            </div>
                            <div class="file-preview" id="file-preview">
                                <p class="hop">Select a file to preview</p>
                            </div>
                        </div>

                        <div class="cost-summary" id="cost-summary">
                            <h3>Estimated Costs</h3>
                            <p>Data Access: <span id="cost-data">$0.00</span></p>
                            <p>Compute (est.): <span id="cost-compute">$0.00</span></p>
                            <p>Storage: <span id="cost-storage">$0.00</span></p>
                            <hr>
                            <p class="total">Total: <span id="cost-total">$0.00</span></p>
                        </div>

                        <div class="buttons">
                            <button onclick="stage_advanceTo('search')">Back to Search</button>
                            <button onclick="stage_advanceTo('process')" class="button-honey">
                                Proceed to Process
                            </button>
                        </div>
                    </div>

                    <!-- PROCESS Stage -->
                    <div class="stage-content" data-stage="process">
                        <div style="display: flex; gap: 1.5rem; height: 100%; min-height: 500px;">
                            <!-- Project Explorer -->
                            <div style="flex: 0 0 250px; display: flex; flex-direction: column;">
                                <h3 style="margin-top: 0; color: var(--orange);">PROJECT ASSETS</h3>
                                <div class="file-tree" id="process-file-tree" style="flex: 1; border-color: var(--honey);">
                                    <!-- Reused File Tree Logic -->
                                </div>
                            </div>

                            <!-- Code Editor -->
                            <div style="flex: 1; display: flex; flex-direction: column;">
                                <h3 style="margin-top: 0; color: var(--honey);">TRAINING LOGIC (train.py)</h3>
                                <div class="code-panel" style="flex: 1;">
                                    <div class="code-header">
                                        <span>python 3.11</span>
                                        <span>UTF-8</span>
                                    </div>
                                    <div class="code-content" id="process-code-content">
                                        <!-- Populated by JS -->
                                    </div>
                                </div>
                                <div style="display: flex; justify-content: flex-end; margin-top: 1rem;">
                                    <button onclick="training_launch()" class="button-honey" style="width: auto; padding-inline: 2rem;">
                                        FEDERALIZE AND LAUNCH
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MONITOR Stage -->
                    <div class="stage-content" data-stage="monitor">
                        <div class="monitor-grid">
                            <div class="monitor-panel">
                                <h3>Overall Progress</h3>
                                <div class="progress-bar">
                                    <div class="fill" id="progress-fill" style="width: 0%"></div>
                                </div>
                                <div class="epoch-display">
                                    Epoch <span id="current-epoch">0</span> / <span id="total-epochs">50</span>
                                    <span class="hop" id="epoch-status">Initializing...</span>
                                </div>
                            </div>

                            <div class="monitor-panel">
                                <h3>Training Loss</h3>
                                <div class="loss-chart">
                                    <canvas id="loss-canvas"></canvas>
                                </div>
                            </div>

                            <div class="monitor-panel span-2">
                                <h3>Node Status</h3>
                                <div class="node-status" id="node-status">
                                    <!-- Populated by JS -->
                                </div>
                            </div>

                            <div class="monitor-panel">
                                <h3>Current Metrics</h3>
                                <p>Loss: <span id="metric-loss">--</span></p>
                                <p>Accuracy: <span id="metric-accuracy">--</span></p>
                                <p>AUC: <span id="metric-auc">--</span></p>
                            </div>

                            <div class="monitor-panel">
                                <h3>Cost Tracker</h3>
                                <p>Running Cost: <span id="running-cost">$0.00</span></p>
                                <p>Budget Limit: <span id="budget-limit">$500.00</span></p>
                                <div class="progress-bar">
                                    <div class="fill" id="cost-progress" style="width: 0%; background: var(--harvestgold);"></div>
                                </div>
                                <button onclick="training_abort()" class="pill-btn button-abort">
                                    Abort Training
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- POST Stage -->
                    <div class="stage-content" data-stage="post">
                        <div class="publish-summary">
                            <h4>Training Summary</h4>
                            <p>Final Loss: <span id="final-loss">0.0234</span></p>
                            <p>Final Accuracy: <span id="final-accuracy">94.2%</span></p>
                            <p>Training Time: <span id="training-time">2h 34m</span></p>
                            <p>Total Cost: <span id="final-cost">$127.50</span></p>
                        </div>

                        <div class="publish-form">
                            <div class="form-group">
                                <label for="model-name">Model Name</label>
                                <input type="text" id="model-name" value="ChestXRay-Classifier-v1">
                            </div>

                            <div class="form-group">
                                <label for="model-description">Description</label>
                                <textarea id="model-description">A 14-class chest X-ray classifier trained on federated data from 5 institutions. Achieves 94.2% accuracy on held-out validation set.</textarea>
                            </div>

                            <div class="form-group">
                                <label for="model-license">License</label>
                                <select id="model-license">
                                    <option value="atlas-standard">ATLAS Standard License</option>
                                    <option value="research-only">Research Only</option>
                                    <option value="commercial">Commercial Use Permitted</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="model-price">Inference Price (per 1000 images)</label>
                                <input type="text" id="model-price" value="$2.50">
                            </div>

                            <div class="buttons">
                                <button onclick="model_publish()" class="button-honey">
                                    Publish to Marketplace
                                </button>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <script src="js/argus.js" type="module"></script>
</body>
</html>
