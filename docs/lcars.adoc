= ARGUS LCARS Interface Design
:toc:
:icons: font

This document captures the specific interaction and visual metaphors used in the ARGUS (ATLAS Resource Graphical User System) LCARS interface.

== The Intelligence Console (Terminal)

The terminal is the primary command and control hub for ARGUS. It functions as a "Unified Intelligence Console" where standard system commands (bash-like), natural language queries (LCARSLM), and agentic UI manipulations are integrated into a single stream.

=== Visual Metaphor: The Tactical Drawer

The terminal is conceptually positioned **between** the Status Header (top panel) and the Operational Workspace (bottom panel). It is designed as a "retractable drawer" that unfurls from behind the main workspace.

.Key Design Principles:
* **Framework Integration**: The terminal is powered by the `LCARSTerminal` component from the `lcars-framework`. It is decoupled from application logic, using a command-registration API.
* **Frameless Integration**: To avoid visual clutter, the terminal does not have its own left-side LCARS framing. Instead, it sits flush against the primary `left-frame` (sidebar), which acts as a "rail" for the drawer.
* **The Workspace Lid**: The horizontal `bar-panel` (containing bars 6-10) functions as the physical "lid" of the bottom panel.
* **Retraction Logic**:
  - **Closed**: The lid sits at the top of the right-frame; the terminal is hidden (height: 0).
  - **Open**: The lid slides downward, revealing the terminal screen above it.
* **Dynamic Elbows**: The LCARS corner elbows are attached to the sliding "lid" rather than the frame, ensuring a flush join at any deployment height. These elbows have a high z-index (300) to sit above overlays like the Marketplace.

=== Interaction Metaphor: The Pullable Access Strip

The primary method for adjusting the terminal's height is the **Access Strip**.

* **The Handle**: A horizontal orange bar (`october-sunset`) floating 5px above the workspace lid.
* **Draggable Workspace**: By "grabbing" this handle, the user physically pulls the entire workspace down, increasing the terminal's visibility. The height limit has been removed to allow full-screen console expansion.
* **Visual Feedback**: The handle glows when active, providing tactile confirmation.
* **Integrated Toggles**:
  - **Tactical Close**: A glowing `mars` red pill at the top-right of the terminal header for quick retraction. Pulses with `lcars-beckon-mars` to signal interactivity.
  - **Primary Toggle**: The rightmost bar segment (`bar-10`) of the workstation lid acts as the toggle switch. Pulses with `lcars-beckon-orange` when the terminal is closed; stops pulsing when open.
  - **Resize Handle**: The Access Strip pulses with `lcars-beckon-orange` when the terminal is open, indicating drag-to-resize capability.

== The Workspace Split-Pane

When a project is OPENed from the Search stage, the right-frame transforms into a **workspace layout** — a vertical stack of two independently-sized panels separated by resize handles.

=== Layout Structure

The workspace activates by adding `workspace-active` to `.right-frame`, switching it to a flex column. The DOM order becomes:

----
.right-frame.workspace-active
├── #intelligence-console .terminal-drawer     (terminal panel)
├── .workspace-resize-handle[data-target=terminal]  (terminal resize grip)
├── #asset-detail-overlay.workspace-expanded   (file browser panel)
├── .workspace-resize-handle[data-target=browser]   (browser resize grip)
├── .bar-panel.main-bar-panel                  (hidden in workspace)
└── #main-content                              (hidden in workspace)
----

=== Independent Panel Sizing

The two panels are **fully decoupled** — resizing one does not affect the other. This is achieved by giving each panel its own bottom-edge resize handle, rather than using a traditional split-pane divider that redistributes a fixed pool of height.

* **Terminal panel**: Height set explicitly by drag (default: 30% of frame). `flex: none`. Min-height: 80px. No upper bound — making the terminal taller makes the page taller.
* **File browser panel**: `flex: none; height: 70vh; min-height: 400px`. Independently resizable via its own handle.
* **Page scrolling**: `.right-frame.workspace-active` has `min-height: 100vh` and `overflow: visible`, so the page scrolls to accommodate the total height of both panels. Users can scroll the top LCARS header off-screen for maximum workspace area.

=== Resize Handles

Both handles share the `.workspace-resize-handle` CSS class:

* **Visual**: 6px horizontal bar in `october-sunset` (orange). On hover/active: `canary` (yellow) with a subtle box-shadow glow.
* **Interaction**: `cursor: row-resize`. Standard mousedown → mousemove → mouseup drag pattern.
* **Cleanup**: Both handles and their event listeners are created by `workspace_expand()` and torn down by `workspace_collapse()`.

=== Bidirectional Tab ↔ Terminal Sync

The file browser sidebar (SOURCE/DATA tabs) and the terminal working directory stay in sync:

* **Tab → Terminal**: Clicking a sidebar tab calls `shell.cd()` to change the terminal's working directory to the corresponding project subdirectory (`/src` or `/data`).
* **Terminal → Tab**: The Shell's `onCwdChange_set()` callback fires whenever `cd` succeeds. The workspace handler resolves the new cwd to a tab ID via `cwdToTab_resolve()` and switches the visual tab accordingly.

== The Dataset Detail Overlay (Gather Mode)

When a dataset tile is clicked from the search results, the asset detail overlay opens in **gather mode** — a selectable FileBrowser showing the dataset's data tree.

=== Visual Identity

The dataset detail uses LCARS hue 200 (sky blue) to distinguish it from project detail (hue 30, orange/honey). The sidebar shows a single "DATA" tab and a "GATHER" label at the bottom corner.

=== Selectable FileBrowser

The FileBrowser component operates in `selectable: true` mode. Short clicks still preview files. Long-pressing (500ms+) toggles selection:

* **File long-press**: Toggles the individual file. Selected files show `.selected-for-gather` — a canary left-border, background tint, and checkmark prefix.
* **Folder long-press**: Toggles all descendant files. If all are selected, deselects all; otherwise selects all.

=== Command Column

The standard INSTALL/CLOSE pills are replaced with:

* **DONE** (canary/gold): Commits gathered selection, closes overlay, marks dataset tile as `.gathered`.
* **ADDITIONAL DATA** (october-sunset/orange): Commits selection, closes overlay, returns to grid for more dataset browsing.
* **CANCEL** (mars/red): Closes without committing.

=== Cost Strip

A real-time cost summary bar at the bottom of the content area:

----
SELECTED: 45 / 293 FILES  |  ESTIMATED COST: $6.92
----

Per-file cost = dataset total cost / total file count. Updates live via `onSelectionChange` callback.

== The Persistent Project Strip

A horizontal strip of compact project chips persists at the top of the Search stage across all search operations. Projects never disappear when dataset results are displayed.

* **Default chip**: honey border on dark background.
* **Active chip** (gather target): solid honey background, black text, glow. Gathered data merges into this project.
* **"+ NEW" chip**: dashed harvestgold border. Clears the active target for new project creation.

First click on a chip sets it as the gather target. Second click (already active) opens the project detail overlay.

== The Multi-Mode Overlay Architecture

The `#asset-detail-overlay` is shared by three consumers — marketplace assets, project detail, and dataset detail — each requiring different sidebar panels, content areas, and command pills. Rather than rewriting the overlay's innerHTML on each open and restoring it on close (a fragile pattern that caused regressions), the overlay uses a **slot-based multi-mode** approach.

=== DOM Structure

The overlay contains both the marketplace's original static DOM and three empty **slot containers**:

----
#asset-detail-overlay[data-mode="marketplace|project|dataset"]
├── .detail-layout
│   ├── .detail-panel
│   │   ├── .lcars-frame
│   │   │   ├── .lcars-sidebar            ← marketplace original (never mutated)
│   │   │   ├── #overlay-sidebar-slot     ← project/dataset sidebar
│   │   │   ├── .lcars-content            ← marketplace original (never mutated)
│   │   │   ├── #overlay-content-slot     ← project/dataset content
│   ├── .detail-command-column            ← marketplace original (CLOSE/INSTALL)
│   ├── #overlay-command-slot             ← project/dataset commands (DONE/ADD/CANCEL or CLOSE/OPEN)
----

=== Mode Switching

The `data-mode` attribute on the overlay root controls visibility via CSS attribute selectors:

* **`marketplace`** (default): Original sidebar, content, and command column are visible. All `.overlay-slot` containers are `display: none`.
* **`project`** / **`dataset`**: Original elements are hidden via `:not(.overlay-slot)` selectors. Slot containers are visible and populated by `projectDetail_populate()` or `datasetDetail_populate()`.

When a project or dataset detail is closed, the close handler:

1. Clears slot innerHTML (via `overlaySlots_clear()`)
2. Sets `data-mode="marketplace"`

The marketplace's original DOM is **never touched**. No restore logic is needed.

=== Workspace Teardown

When the user triggers FEDERALIZE AND LAUNCH from within an expanded workspace, the system must fully tear down the workspace before transitioning to the Monitor stage. The `workspace_teardown()` function handles this:

1. Calls `workspace_collapse()` — removes resize handles, restores `rightFrame` layout, shows stage content
2. Hides the `asset-detail-overlay` and resets `data-mode` to `marketplace`
3. Clears all slot contents
4. Closes the terminal (monitor has its own telemetry)

This ensures the Monitor stage content renders unobstructed.

== Operational Modes

The terminal dynamically adapts its persona and capabilities based on the active SeaGaP stage.

=== Search Mode (AI Core)
During the Search stage, the terminal acts as an AI-driven discovery engine.
* **Prompt**: `ARGUS: SEARCH >`
* **Agentic Logic**: The AI can automatically select datasets in the visual grid using the `[SELECT: ID]` intent parser.
* **Telematic Readout**: The visual grid below the terminal serves as a secondary evidence display, updating in real-time as the AI identifies relevant cohorts.

=== Developer Mode (Technical Shell)
Upon entering the Process stage, the console transitions into a technical coding environment.
* **Prompt**: `dev@argus:~/src/project $`
* **Styling**: The UI automatically switches to a monospaced font (**Inconsolata**), clears history, and enables mixed-case input/output for technical accuracy.
* **Commands**: Supports standard linux-style commands (`ls`, `cd`, `pwd`, `mkdir`, `rm`, `python`).

== Typography: The Dual-Voice System

ARGUS uses the **Antonio** font family with a selective casing strategy:

* **The System Voice (Uppercase)**: All structural elements, headers, prompts, and button labels are strictly uppercase.
* **The Data Voice (Mixed Case)**: Terminal output (AI responses, file contents) and user input allow mixed case to preserve technical precision and improve readability.
* **Visual Polish**: Terminal readouts feature a soft text-shadow glow, simulating a high-density CRT display.

== LCARS Component System

ARGUS is built on a reusable **LCARS Framework** (`src/lcars-framework/`) that decouples data simulation from UI rendering.

=== Telemetry Service
The telemetry system uses a provider-renderer pattern:
* **Generators**: Pure logic classes (e.g., `ProcessGenerator`, `NetworkGenerator`) that produce data objects.
* **Renderers**: Visual components (e.g., `ListRenderer`, `LogRenderer`) that take data and update the DOM.
* **Service**: A central orchestrator that manages registration and the 800ms "flicker" update loop.

=== Workflow Tracker
The `WorkflowTracker` procedurally generates linear pipelines (like SeaGaP) with:
* **Stations**: Circular "stops" with associated labels and status classes (`active`, `visited`).
* **Connectors**: Dynamic line segments between stops.
* **Integrated Telemetry**: Each station includes a "hanging" telemetry window that populates via the `TelemetryService`.

=== Asset Card Component
The `AssetCard` (`src/ui/components/AssetCard.ts`) is a shared UI primitive used to represent both Marketplace assets and User Projects. It unifies the visual language between external resources and internal workspaces.

.Features:
* **Polymorphic Rendering**: Adapts metadata display (stars/version for assets vs. dataset counts/modification date for projects).
* **Integrated Actions**: Supports an optional primary action pill (INSTALL, SELECT, OPEN).
* **Identity States**: Visually flags "Installed" or "Active" items via CSS class toggles.

=== Architecture

The system consists of two parts:

1. **TypeScript Generator** (`src/ui/components/LCARSFrame.ts`)
   - Creates DOM structures for LCARS frames
   - Handles panel configuration and layout
   - Exposes utility functions to window for HTML event handlers

2. **CSS Design System** (`dist/css/lcars-components.css`)
   - Defines base styles using CSS custom properties
   - Computes color shades via HSL
   - Handles responsive breakpoints

=== The Hue-Based Color System

All LCARS component colors derive from a single `--lcars-hue` value (0-360). The CSS automatically computes four shade variants:

[source,css]
----
.lcars-frame {
    --lcars-hue: 200;           /* Blue family */
    --lcars-sat: 70%;
    --lcars-light-1: 75%;       /* Lightest */
    --lcars-light-2: 65%;
    --lcars-light-3: 55%;
    --lcars-light-4: 45%;       /* Darkest */

    /* Computed shades */
    --lcars-shade-1: hsl(var(--lcars-hue), var(--lcars-sat), var(--lcars-light-1));
    --lcars-shade-2: hsl(var(--lcars-hue), var(--lcars-sat), var(--lcars-light-2));
    /* ... */
}
----

.Predefined Hue Values
[cols="1,1,2"]
|===
|Name |Hue |Usage

|BLUE/SKY |200 |Default marketplace assets
|ORANGE |30 |Main application frame
|GREEN/FDA |140 |FDA regulatory tools
|PURPLE/NEBULA |270 |Special categories
|RED/MARS |0 |Alerts, warnings
|GOLD |45 |Highlights
|===

=== LCARS Frame Structure

A complete LCARS frame consists of four grid areas:

----
╭━━━━━━━━━━╮━━━━━━━━━━━━━━━━━━━━━━━━━━━━
┃  ELBOW   ┃  TOP BAR (title + actions)
┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━
┃ PANEL 1  ┃
┃──────────┃  CONTENT AREA
┃ PANEL 2  ┃  (scrollable)
┃──────────┃
┃ PANEL 3  ┃
┃ [spacer] ┃
┃ PANEL N  ┃  ← corner radius
╰━━━━━━━━━━╯─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
----

* **Elbow**: Curved corner piece connecting top bar to sidebar
* **Top Bar**: Horizontal header with title, metadata, and action buttons
* **Sidebar**: Vertical stack of navigation panels (same width, varying heights/shades)
* **Content**: Main scrollable content area

=== Panel Design Principles

LCARS panels follow strict design rules:

1. **Uniform Width**: All sidebar panels are the same width. Visual variety comes from color and height, not width.
2. **Shade Cycling**: Panels alternate through shade variants (1-4) for visual rhythm
3. **Height Variants**: Panels can have different heights (`tall`, `medium`, `short`)
4. **Corner Radii**: Only the elbow (top-left) and bottom panel (bottom-left) have rounded corners
5. **Text Alignment**: Panel labels align right (LCARS convention for left sidebars)
6. **Spacer Element**: A colored spacer fills remaining height between panels and the bottom corner

=== Usage Example

**HTML Structure:**
[source,html]
----
<div class="lcars-frame" style="--lcars-hue: 200;">
    <div class="lcars-elbow"></div>
    <div class="lcars-top-bar">
        <h1>Title</h1>
        <button class="close-btn">CLOSE</button>
    </div>
    <div class="lcars-sidebar">
        <a class="lcars-panel" data-shade="1" data-height="tall">SECTION 1</a>
        <a class="lcars-panel" data-shade="2">SECTION 2</a>
        <a class="lcars-panel" data-shade="3">SECTION 3</a>
        <div class="lcars-sidebar-spacer" data-shade="4"></div>
        <a class="lcars-panel lcars-corner-bl" data-shade="1">SECTION N</a>
    </div>
    <div class="lcars-content">
        <!-- Scrollable content -->
    </div>
</div>
----

**Dynamic Theming (TypeScript):**
[source,typescript]
----
// Change color scheme at runtime
const frame = document.getElementById('my-lcars-frame');
frame.style.setProperty('--lcars-hue', '140');  // Switch to green
----

=== Marketplace Integration

The Asset Detail Overlay demonstrates the "Floating Command Module" pattern, where critical actions are decoupled from the information display to maximize screen real estate and mimic hardware controls.

==== Visual Style: PADD Aesthetic
The asset tiles and detail frames use an asymmetrical "PADD" (Personal Access Display Device) geometry:
* **Thick Top Bar:** 10px solid accent bar (Sky Blue or FDA Green).
* **Rounded Corner:** Bottom-right corner has a 24px radius (`border-radius: 0 0 24px 0`), creating a distinct physical shape.
* **No Borders:** Replaced thin outlines with deep contrast backgrounds and shadow glows.

==== Floating Command Pills
Action buttons are removed from the internal content area and placed in a dedicated **Command Column** to the right of the main panel.

* **Structure:**
  [source,html]
  ----
  <div class="detail-layout">
      <!-- Main Information Display -->
      <div class="detail-panel">...</div>

      <!-- Floating Command Column -->
      <div class="detail-command-column">
          <button class="pill-btn close-pill">CLOSE</button>
          <button class="pill-btn install-pill">INSTALL</button>
      </div>
  </div>
  ----
* **Dynamic Coloring:** The INSTALL pill automatically inherits the asset's hue (Blue vs. FDA Green) via CSS variables.
* **Status Feedback:** The INSTALL pill contains a progress bar overlay and status text (`READY` -> `INSTALLING` -> `INSTALLED`).

==== Color Coding
* **Standard Assets:** `--lcars-hue: 200` (Sky Blue)
* **FDA Regulatory Tools:** `--lcars-hue: 140` (Green)
* **Close Actions:** `var(--mars)` (Red)

[source,typescript]
----
// In marketplace/view.ts
const hue = asset.type === 'fda' ? 140 : 200;
lcarsFrame.style.setProperty('--lcars-hue', String(hue));
----

== Interactive Affordances: The Beckon Pulse

In Michael Okuda's original LCARS designs for The Next Generation, instrument panels were never entirely static. Panels flickered, shifted, and cycled through subtle brightness changes to suggest ongoing background system activity. This visual "life" served a dual purpose: it made the interface feel like a living system, and it drew attention to active controls without explicit labels or iconography.

ARGUS adopts this principle as a formal visual language pattern called the **Beckon Pulse**. Any interactive element that lacks an obvious affordance (no label, no icon, no conventional button shape) uses a slow brightness oscillation to signal "interact with me."

=== The Pattern

The Beckon Pulse is a `3-3.5s` CSS animation that oscillates `filter: brightness()` between `1.0` and `1.15-1.25`, with an optional `box-shadow` glow. The effect is subtle enough to register in peripheral vision without demanding attention. On hover, the animation stops and the element shows a static highlight, confirming interactivity.

=== Variants

[cols="1,2,2"]
|===
| Variant | Animation | Usage

| `lcars-beckon-orange`
| brightness 1.0 → 1.15, soft orange glow
| Open/activate controls (e.g., `bar-6` terminal opener)

| `lcars-beckon-mars`
| brightness 1.0 → 1.25, red glow intensifies
| Close/dismiss controls (e.g., terminal close pill)

| `.lcars-beckon` (utility class)
| Applies `lcars-beckon-orange` by default
| Any generic interactive element
|===

=== Contextual Activation

Beckon animations are **context-sensitive**: they only pulse when the affordance is relevant. For example, `bar-6` (the terminal opener) beckons only when the terminal is closed. Once the terminal is open, bar-6 stops pulsing — the user's attention should shift to the terminal content and its close control, which now takes over the beckon duty.

This prevents **pulse fatigue**: the visual rhythm of the interface changes as the user navigates, with different elements beckoning at different moments rather than everything pulsing simultaneously.

=== CSS Usage

[source,css]
----
/* Apply via utility class */
.my-interactive-element {
    /* ... */
}
.my-interactive-element.lcars-beckon {
    animation: lcars-beckon-orange 3.5s ease-in-out infinite;
}
.my-interactive-element.lcars-beckon:hover {
    animation: none;
}

/* Or apply a specific variant directly */
.my-close-button {
    animation: lcars-beckon-mars 3s ease-in-out infinite;
}
----

=== Toggling via JavaScript

[source,typescript]
----
// Start beckoning
element.classList.add('lcars-beckon');

// Stop beckoning (e.g., when the associated panel is open)
element.classList.remove('lcars-beckon');
----

== Implementation Details

* **Global Component**: The `LCARSTerminal` is a global singleton.
* **Intent Parsing**: The `terminalCommand_handle()` dispatcher in `argus.ts` routes commands to `workflowCommand_handle()` (search/add/review/mount/simulate) and `aiQuery_handle()` (LLM queries). AI responses are parsed by `aiResponse_process()` to trigger system actions (selecting data, transitioning stages).
* **Contextual Awareness**: The AI engine receives the full dataset catalog and the user's current "Selection Buffer" with every query, ensuring high-fidelity RAG (Retrieval Augmented Generation) reasoning.
* **LCARS Frame Generator**: The `lcarsFrame_create()` function and related utilities are exposed on the `window` object for use in HTML event handlers.